<% content_for(:title, @product.title) %>
<% content_for(:description, @product.summary.presence || @product.title) %>
<% content_for(:meta_image_url, url_for(@product.top_image.product_image)) %>

<div class="mx-auto sm:max-w-xl md:max-w-full lg:max-w-screen-xl md:px-24 lg:px-8 lg:py-1">
  <div class="grid gap-12 row-gap-8 lg:grid-cols-2">
    <div>
      <%= image_tag @product.top_image.product_image, alt: @product.title, class: 'w-full rounded shadow-lg' %>
    </div>

    <div class="flex flex-col justify-center">
      <div class="max-w-xl mb-6">
        <p class="text-base leading-6 text-indigo-500 font-semibold tracking-widest">
          <%= "#{@product.released_on} Released by" %>
          <%= link_to_active @product.user %>
        </p>
        <h2 class="max-w-lg mb-1 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl sm:leading-none">
          <%= @product.title %>
        </h2>

        <div class="max-w-xl mb-2 -px-1">
          <% @product.technologies.each do |technology| %>
            <div class="span px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-200 text-gray-700">
              <%= technology.name %>
            </div>
          <% end %>
        </div>

        <div class="max-w-xl">
          <%= link_to_blank @product.url, @product.url %>
          <br>
          <%= link_to_blank @product.source_url, @product.source_url %>
        </div>
        <div class="mt-3">
          <%= simple_format h(@product.summary), class: 'text-base text-gray-700 md:text-lg' %>
        </div>
      </div>

      <ul>
        <% @product.media.each do |medium| %>
          <li class="flex mb-2">
            <span class="mr-1">
              <i class="fas fa-external-link-alt"></i>
            </span>
            <%= link_to_blank medium.title, medium.url %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>

<br>
<br>
<br>
以下はデータ表示用
<br>
<br>
<br>

<% @product.images.with_attached_product_image.each do |image| %>
  <div>
    <%= image_tag image.product_image, alt: @product.title, width: '600px' %>
    <% if @product.permitted_edit?(current_user) %>
      <%= link_to '編集', edit_product_product_image_path(@product, image) %>
      <%= link_to '削除', product_product_image_path(@product, image), method: :delete %>
    <% end %>
  </div>
<% end %>

<br>
<% if @product.permitted_edit?(current_user) %>
  <%= link_to 'Edit', edit_product_path(@product) %>
  <br>
  <%= link_to 'Destroy', @product, data: { confirm: 'Are you sure?' }, method: :delete %>
  <br>
  <%= link_to '画像登録', new_product_product_image_path(@product) %>
  <br>
  <%= link_to 'メディア登録', new_product_product_medium_path(@product) %>
<% end %>
